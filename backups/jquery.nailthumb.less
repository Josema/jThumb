(function(a){a.fn.extend({jThumb:function(b){return new a.jThumb(this,b)}});a.jThumb=function(b,c){var e=[];var k;c=a.extend({},a.jThumb.defaults,c);this.set=function(n,l){k=a.extend({},c,n);if(typeof(l)=="undefined"){l=true}var m,o;if(!l){m=0;b.each(function(){e[m]={};e[m].index=m;e[m].cElem=this;e[m].cWidth=a(e[m].cElem).width();e[m].cHeight=a(e[m].cElem).height();o=a(e[m].cElem).find(k.img)[0];if(o!=null&&typeof(o)=="object"&&a(o).is("img")){e[m].iElem=o}else{if(typeof(k.onError)=="function"){k.onError(a.jThumb.error[0],e[m])}}m+=1})}for(m in e){if(e[m].iElem!=null){h(a(e[m].iElem).attr("src"),d,m)}}};this.set(null,false);this.getThumbByIndex=function(l){return e[l]};function d(l,r,q){e[q].iWidth=l;e[q].iHeight=r;var o=[];o=o.concat(f(k.align));o=o.concat(f(a(e[q].cElem).attr(k.attrName)));o=o.concat(f(a(e[q].iElem).attr(k.attrName)));var n=g(o);var s=higher=false;if(e[q].iWidth>e[q].cWidth){s=true}if(e[q].iHeight>e[q].cHeight){higher=true}var m;if((n.allowResize&&(s&&higher))||(n.allowZoom&&(!s||!higher))){m=j(e[q].cWidth,e[q].cHeight,e[q].iWidth,e[q].iHeight)}else{m=[e[q].iWidth,e[q].iHeight]}a(e[q].iElem).width(m[0]);a(e[q].iElem).height(m[1]);var p=i(n.alignX,n.alignY,e[q].cWidth,e[q].cHeight,m[0],m[1]);a(e[q].iElem).css(k.moveX,p[0]);a(e[q].iElem).css(k.moveY,p[1])}function h(n,o,l){var m=new Image();m.src=n;m.onload=function(){if(typeof k.onLoadImage=="function"){k.onLoadImage(m,e[l])}o(this.width,this.height,l)}}function f(q){var m=[];var r=0;if(q!=null&&q!=undefined&&typeof q=="string"&&q.length>=3){var p=jQuery.trim(q).split(" ");var l;for(var o=0;o<p.length;++o){l=$jThumb.regexp.exec(p[o]);if(l!=undefined&&l!=null&&l[1]!=undefined){m[r]=[(l[1]).toLowerCase()];if(l[4]!=undefined){m[r][1]=[l[4],((l[5]==undefined)?k.standardUnit:l[5])]}r+=1}}}return m}function g(p){var s=jQuery.trim(a.jThumb.defaults.align).split(" ");var n={alignX:s[0],alignY:s[1],paddingX:0+k.standardUnit,paddingY:0+k.standardUnit,allowResize:k.allowResize,allowZoom:k.allowZoom};var q,m,l;var o,r;for(q=(p.length-1);q>=0&&(m==null||l==null);--q){if(p[q][0]=="left"||p[q][0]=="right"||p[q][0]=="center"){if(m!=null&&(p[q][0]=="center"||m[0]=="center")){l=m;m=p[q]}else{if(m==null){m=p[q]}}}else{if(l==null&&(p[q][0]=="top"||p[q][0]=="bottom")){l=p[q]}else{if(o==null&&p[q][0]=="allowresize"){n.allowResize=true;o=true}else{if(r==null&&p[q][0]=="allowzoom"){n.allowZoom=true;r=true}else{if(o==null&&p[q][0]=="noresize"){n.allowResize=false;o=true}else{if(r==null&&p[q][0]=="nozoom"){n.allowZoom=false;r=true}}}}}}}if(m!=undefined){n.alignX=m[0];if(m[1]!=undefined){n.paddingX=m[1][0]+(((m[1][1]!=undefined))?m[1][1]:k.standardUnit)}}if(l!=undefined){n.alignY=l[0];if(l[1]!=undefined){n.paddingY=l[1][0]+(((l[1][1]!=undefined))?l[1][1]:k.standardUnit)}}return n}function j(l,o,m,p){var n=Math.round((m*o)/p);var q=Math.round((p*l)/m);return(q<o)?[n,o]:[l,q]}function i(m,r,l,o,n,p){var q=newY=0;if(m=="right"){q=(l-n)}else{if(m=="center"){q=Math.round((l-n)/2)}}if(r=="bottom"){newY=(o-p)}else{if(r=="center"){newY=Math.round((o-p)/2)}}return[q,newY]}};a.jThumb.defaults={img:"> img",align:"center center",allowResize:false,allowZoom:false,onError:null,onLoadImage:null,attrName:"jthumb",moveX:"margin-left",moveY:"margin-top",standardUnit:"px"};$jThumb={regexp:/(center|left|top|right|bottom|allowresize|allowzoom|noresize|nozoom)(\((([-0-9]+)(%|px|pt|em|cm|in)?)?\))?/i};a.jThumb.error=["Image not found inside the container"]})(jQuery);