(function(a){a.fn.extend({jThumb:function(b){return new a.jThumb(this,b)}});a.jThumb=function(b,c){var f=[];var l;var e=0;c=a.extend({},a.jThumb.defaults,c);this.set=function(o,m){l=a.extend({},c,o);if(typeof m=="undefined"){m=true}var n,p;if(!m){n=0;b.each(function(){f[n]={};f[n].index=n;f[n].cElem=this;f[n].cWidth=a(f[n].cElem).width();f[n].cHeight=a(f[n].cElem).height();p=a(f[n].cElem).find(l.img)[0];if(p!=null&&typeof p=="object"&&a(p).is("img")){i(p,n)}else{if(typeof l.onError=="function"){l.onError(a.jThumb.error[0],f[n])}}n+=1})}else{for(n in f){if(f[n].iElem!=null&&f[n].iWidth>0&&f[n].iHeight){d(n)}}}};this.set(null,false);this.getThumbByIndex=function(m){return f[m]};function d(p){if(typeof l.onBefore=="function"){l.onBefore(f[p])}var o=[];o=o.concat(g(l.align));o=o.concat(g(a(f[p].cElem).attr(l.attrName)));o=o.concat(g(a(f[p].iElem).attr(l.attrName)));var n=h(o);var m=k(f[p].cWidth,f[p].cHeight,f[p].iWidth,f[p].iHeight,n.crop,n.resize,n.zoom);a(f[p].iElem).width(m[0]);a(f[p].iElem).height(m[1]);var r=[];r[0]=(n.paddingX[1]=="%")?Math.round((n.paddingX[0]*f[p].cWidth)/100):n.paddingX[0];r[1]=(n.paddingY[1]=="%")?Math.round((n.paddingY[0]*f[p].cHeight)/100):n.paddingY[0];var q=j(n.alignX,n.alignY,f[p].cWidth,f[p].cHeight,m[0],m[1]);a(f[p].iElem).css(l.moveX,(q[0]+r[0]));a(f[p].iElem).css(l.moveY,(q[1]+r[1]));if(typeof l.onAfter=="function"){l.onAfter(f[p])}if(e==b.length&&typeof l.onFinish=="function"){l.onFinish(f[p])}}function i(o,n){var m=a(document.createElement("img"));m.bind("load",{img:this},function(){e+=1;f[n].iElem=o;f[n].iWidth=this.width;f[n].iHeight=this.height;if(typeof l.onLoadImage=="function"){l.onLoadImage(tempImg,f[n])}d(n)});m.attr("src",a(o).attr("src"))}function g(r){var o=[];var s=0;if(r!=null&&r!=undefined&&typeof r=="string"&&r.length>=3){var q=jQuery.trim(r).split(" ");var m;for(var p=0;p<q.length;++p){m=a.jThumb.consts.regexp.exec(q[p]);if(m!=undefined&&m!=null&&m[1]!=undefined){o[s]=[(m[1]).toLowerCase()];if(m[4]!=undefined){o[s][1]=[m[4]]}if(m[5]!=undefined){o[s][1][1]=m[5]}s+=1}}}return o}function h(r){var p,o,n,q,m,u,s=jQuery.trim(a.jThumb.defaults.align).split(" ");var t={alignX:s[0],alignY:s[1],paddingX:[0],paddingY:[0],crop:l.crop,resize:l.resize,zoom:l.zoom};for(p=(r.length-1);p>=0;--p){if((o==null||n==null)&&(r[p][0]=="left"||r[p][0]=="right"||r[p][0]=="center")){if(o!=null&&r[p][0]!="center"&&o[0]=="center"){n=o;o=r[p]}else{if(o==null){o=r[p]}}}else{if(n==null&&(r[p][0]=="top"||r[p][0]=="bottom")){n=r[p]}else{if(q==null&&r[p][0]=="crop"){t.crop=true;q=true}else{if(m==null&&r[p][0]=="resize"){t.resize=true;m=true}else{if(u==null&&r[p][0]=="zoom"){t.zoom=true;u=true}else{if(q==null&&r[p][0]=="nocrop"){t.crop=false;q=true}else{if(m==null&&r[p][0]=="noresize"){t.resize=false;m=true}else{if(u==null&&r[p][0]=="nozoom"){t.zoom=false;u=true}}}}}}}}}if(o!=null){t.alignX=o[0];if(o[1]!=null&&o[1][0].length>0){t.paddingX[0]=parseInt(o[1][0]);if(o[1][1]!=null){t.paddingX[1]=o[1][1]}}}if(n!=null){t.alignY=n[0];if(n[1]!=null&&n[1][0].length>0){t.paddingY[0]=parseInt(n[1][0]);if(n[1][1]!=null){t.paddingY[1]=n[1][1]}}}return t}function k(s,o,r,n,p,m,t){var u=[r,n];if(!p||(m&&r>s&&n>o)||(t&&(r<s||n<o))){var q=Math.round((n*s)/r);u=((!p&&q>o)||(p&&q<o&&(m||t)))?[Math.round((r*o)/n),o]:[s,q]}return u}function j(n,s,m,p,o,q){var r=newY=0;if(n=="right"){r=(m-o)}else{if(n=="center"){r=Math.round((m-o)/2)}}if(s=="bottom"){newY=(p-q)}else{if(s=="center"){newY=Math.round((p-q)/2)}}return[r,newY]}};a.jThumb.defaults={img:"> img",align:"center center",crop:true,resize:true,zoom:false,onError:null,onLoadImage:null,onBefore:null,onAfter:null,onFinish:null,attrName:"jthumb",moveX:"margin-left",moveY:"margin-top"};a.jThumb.consts={regexp:/(center|left|top|right|bottom|resize|noresize|zoom|nozoom|crop|nocrop)(\((([-0-9]+)(%|px)?)?\))?/i};a.jThumb.error=["Image not found inside the container"]})(jQuery);